<div id="pingChart" style="width: 100%; height: 400px"></div>
<hr />
<div id="randomChart" style="width: 100%; height: 400px"></div>

<!-- <button type="button" class="fillWidth" onclick="app.fadingPartialChange('#main','about');">learn more</button><br />
 -->
<script>
	app.page = {};

	app.page.init = function(){
		app.page.pingChart = new Highcharts.Chart({
			chart: {
				renderTo: 'pingChart',
				type: 'line',
				backgroundColor: '#00000',
				plotBackgroundColor: '#000000',
			},
				title: {
				text: 'Ping time to google.com'
			},
				xAxis: {
				title: {
					text: 'timestamp'
				}
			},
				yAxis: {
				title: {
					text: 'ping seconds'
				}
			},
			series: [
				{
					name: 'PingTime',
					data: []
				}, 
			]
	  	});
	  	//
	  	app.page.getPingData();


	  	app.page.randomChart = new Highcharts.Chart({
			chart: {
				renderTo: 'randomChart',
				type: 'line',
				backgroundColor: '#00000',
				plotBackgroundColor: '#000000',
			},
				title: {
				text: 'Random numbers generated by the server'
			},
				xAxis: {
				title: {
					text: 'timestamp'
				}
			},
				yAxis: {
				title: {
					text: 'randm number'
				}
			},
			series: [
				{
					name: 'Random Number',
					data: []
				}, 
			]
	  	});
	  	//
	  	app.page.getRandomData();
	}

	app.page.randomLastTimeStamp = 0;
	app.page.randomRefreshTimeout = 1000;

	app.page.getRandomData = function(){
		params = {};
		params.check = "check_random_numbers";
		params.since = app.page.randomLastTimeStamp;
		app.apiRequest("getData", "app.page.processGetRandomData", params);
	}

	app.page.processGetRandomData = function(api){
		if(api.error != "OK"){ app.showError(api.error); }
		else{
			if(api.check.length == 0){
				app.showError("No data for this check");
			}else{
				var series = app.page.randomChart.series[0];
				for (var i in api.check){
					var shift = series.data.length > 30;
					series.addPoint([parseInt(api.check[i].timeStamp), parseInt(api.check[i].number)], true, shift);
					if(api.check[i].timeStamp > app.page.randomLastTimeStamp){
						app.page.randomLastTimeStamp = api.check[i].timeStamp;
					}
				}
			}
			setTimeout(app.page.getRandomData, app.page.randomRefreshTimeout);
		}
	}

	app.page.pingLastTimeStamp = 0;
	app.page.pingRefreshTimeout = 10000;

	app.page.getPingData = function(){
		params = {};
		params.check = "ping_google.com";
		params.since = app.page.pingLastTimeStamp;
		app.apiRequest("getData", "app.page.processGetPingData", params);
	}

	app.page.processGetPingData = function(api){
		if(api.error != "OK"){ app.showError(api.error); }
		else{
			if(api.check.length == 0){
				app.showError("No data for this check");
			}else{
				var series = app.page.pingChart.series[0];
				for (var i in api.check){
					var shift = series.data.length > 30;
					series.addPoint([parseInt(api.check[i].timeStamp), parseInt(api.check[i].pingDuration)], true, shift);
					if(api.check[i].timeStamp > app.page.pingLastTimeStamp){
						app.page.pingLastTimeStamp = api.check[i].timeStamp;
					}
				}
			}
			setTimeout(app.page.getPingData, app.page.pingRefreshTimeout);
		}
	}

</script>